<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper   
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ReviewPhoto">
	<select id="selectReviewPhotoDetView" parameterType="map" resultType="ReviewPhotoDto">
		SELECT *
		FROM (SELECT a.*, rownum rnum 
			FROM (SELECT REVIEWPHOTO.REVIEWID, REVIEWPHOTO.PHOTOID, REVIEWPHOTO.PHOTOPATH 
				FROM SHOPREVIEW
				INNER JOIN REVIEWPHOTO
				ON SHOPREVIEW.REVIEWID=REVIEWPHOTO.REVIEWID
				WHERE RESTAURANTID=#{restaurantId}
				ORDER BY SHOPREVIEW.reviewId desc) a)
		<![CDATA[
			WHERE REVIEWID >= #{totCntOfReviewStart} AND REVIEWID <= #{totCntOfReviewEnd}
		]]>
	</select>
	
	<select id="getNewReviewPhotoDetView" resultType="int">
		SELECT MAX(photoId) FROM REVIEWPHOTO
	</select>
	
	<insert id="insertReviewPhotoDetView" parameterType="ReviewPhotoDto">
		INSERT INTO REVIEWPHOTO(photoId, photoPath, reviewId)
		VALUES(#{photoId}, #{photoPath}, #{reviewId})
	</insert>
</mapper>







